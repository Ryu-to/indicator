<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Indicator</title>
  <link rel="stylesheet" href="style2.css">
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog=="
  crossorigin="anonymous" />
  
</head>

<body>
  <header>
    <h2>5F</h2>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!--ナビの数が増えた場合縦スクロールするためのdiv※不要なら削除-->
        <ul>
          <li><a href="index.html">2F</a></li>
          <li><a href="index2.html">3F</a></li>
          <li><a href="index3.html">4F</a></li>
          <li><a href="index4.html">5F</a></li>
        </ul>
      </div>
    </nav>
    <nav class="gnav">
      <div class="btn-box">
        <a href="#" id="501" class="btn_02">501</a>
        <a href="#" id="502" class="btn_02">502</a>
        <a href="#" id="503" class="btn_02">503</a>
        <a href="#" id="504" class="btn_02">504</a>
        <a href="#" id="505" class="btn_02">505</a>
        <a href="#" id="506" class="btn_02">506</a>
        <a href="#" id="507" class="btn_02">507</a>
        <a href="#" id="508" class="btn_02">508</a>
      </div>
    </nav>
  </header>

  <main>

    <div class="floorBox">
      <img id="floorMap" src="img/BH_4F.png" alt="">

      <div id="section501"><img class="hideMapA" src="img/b01.png" alt="">
      </div>
      <div id="section502"><img class="hideMapB" src="img/b02.png" alt="">
      </div>
      <div id="section503"><img class="hideMapC" src="img/b03.png" alt="">
      </div>
      <div id="section504"><img class="hideMapD" src="img/b02.png" alt="">
      </div>
      <div id="section505"><img class="hideMapE" src="img/b03.png" alt="">
      </div>
      <div id="section506"><img class="hideMapF" src="img/b04.png" alt="">
      </div>
      <div id="section507"><img class="hideMapG" src="img/b05.png" alt="">
      </div>
      <div id="section508"><img class="hideMapH" src="img/b06.png" alt="">
      </div>
    </div>

    <div id="button">
      <a id="save" href="#" class="btn_02">SAVE</a>
      <a id="clear" href="#" class="btn_02">CLEAR</a>
      <a id="reload" href="#" class="btn_02">RELOAD</a>

    </div>

  </main>

<footer>
  <button class="add" id="add">
    <i class="fas fa-plus"></i> Add
  </button>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/1.2.2/marked.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>

    var roomFive = [];

    // Humberger
      $(".openbtn").click(function () {//ボタンがクリックされたら
        $(this).toggleClass('active');//ボタン自身に activeクラスを付与し
        $("#g-nav").toggleClass('panelactive');//ナビゲーションにpanelactiveクラスを付与
      });

      $("#g-nav a").click(function () {//ナビゲーションのリンクがクリックされたら
        $(".openbtn").removeClass('active');//ボタンの activeクラスを除去し
        $("#g-nav").removeClass('panelactive');//ナビゲーションのpanelactiveクラスも除去
      });

      // ページ遷移
    

    // クリックで画像を表示し配列roomFiveへpush
    $('#section501').toggle();
    $(function () {
      $("#501").click(function () {
        $("#section501").toggle();
        roomFive.push('501');
        console.log(roomFive);
      });
    });

    $("#section502").toggle();
    $(function () {
      $("#502").click(function () {
        $("#section502").toggle();
        roomFive.push('502');
        console.log(roomFive);
      });
    });

    $("#section503").toggle();
    $(function () {
      $("#503").click(function () {
        $("#section503").toggle();
        roomFive.push('503');
        console.log(roomFive);
      });
    });

    $("#section504").toggle();
    $(function () {
      $("#504").click(function () {
        $("#section504").toggle();
        roomFive.push('504');
        console.log(roomFive);
      });
    });


    $("#section505").toggle();
    $(function () {
      $("#505").click(function () {
        $("#section505").toggle();
        roomFive.push('505');
        console.log(roomFive);
      });
    });

    $("#section506").toggle();
      $(function () {
        $("#506").click(function () {
          $("#section506").toggle();
          roomFive.push('506');
          console.log(roomFive);
        });
      });

      $("#section507").toggle();
        $(function () {
          $("#507").click(function () {
            $("#section507").toggle();
            roomFive.push('507');
            console.log(roomFive);
          });
        });

        $("#section508").toggle();
          $(function () {
            $("#508").click(function () {
              $("#section508").toggle();
              roomFive.push('508');
              console.log(roomFive);
            });
          });

    //1.Save クリックイベント
    $('#save').on('click', function () {
      localStorage.setItem('roomFive', roomFive);
    });


    //2.clear クリックイベント
    $('#clear').on('click', function () {
      $('.hideMapA').hide();
      $('.hideMapB').hide();
      $('.hideMapC').hide();
      $('.hideMapD').hide();
      $('.hideMapE').hide();
      $('.hideMapF').hide();
      $('.hideMapG').hide();
      $('.hideMapH').hide();
      localStorage.removeItem('roomFive');
    });

  
    // Point: 「.val()」は()に何か入れると入れた値で上書きする!
    // 空の文字列で上書き
    //3.ページ読み込み：保存データ取得表示
    if (localStorage.getItem('roomFive')) { // 値が保存されていれば 
      const text = localStorage.getItem('roomFive'); // データを取得
      var result19 = text.includes('501');
      if (result19 == true) {
        console.log(result19)
        $("#section501").show();
      };
      var result20 = text.includes('502');
      if (result20 == true) {
        console.log(result20)
        $("#section502").show();
      };
      var result21 = text.includes('503');
      if (result21 == true) {
        console.log(result21)
        $("#section503").show();
      };
      var result22 = text.includes('504');
      if (result22 == true) {
        console.log(result22)
        $("#section504").show();
      };
      var result23 = text.includes('505');
      if (result23 == true) {
        console.log(result23)
        $("#section505").show();
      };
      var result24 = text.includes('506');
      if (result24 == true) {
        console.log(result24)
        $("#section506").show();
      };
      var result25 = text.includes('507');
      if (result25 == true) {
        console.log(result25)
        $("#section507").show();
      };
      var result26 = text.includes('508');
      if (result26 == true) {
        console.log(result26)
        $("#section508").show();
      };
    };

    // リロード
    $('#reload').click(function () {
        location.reload();
      });
  // memo
  // 要素を取得する
  const addBtn = document.getElementById('add')

  // ローカルストレージからデータを取得する
  const notes = JSON.parse(localStorage.getItem('notes'))

  // メモ帳追加処理を実行
  if (notes) {
    notes.forEach(note => addNewNote(note))
  }

  // 作成ボタンのクリックイベントの登録
  addBtn.addEventListener('click', () => addNewNote())

  function addNewNote(text = '') {
    // div要素を作成
    const note = document.createElement('div')
    // noteクラスを追加
    note.classList.add('note')

    // メモ帳を追加
    note.innerHTML = `
    <div class="tools">
        <button class="edit"><i class="fas fa-edit"></i></button>
        <button class="delete"><i class="fas fa-trash-alt"></i></button>
    </div>
    <div class="main ${text ? "" : "hidden"}"></div>
    <textarea class="${text ? "hidden" : ""}"></textarea>
    `

    // 操作に必要な要素を取得
    const editBtn = note.querySelector('.edit')
    const deleteBtn = note.querySelector('.delete')
    const main = note.querySelector('.main')
    const textArea = note.querySelector('textarea')

    // テキストエリアに引数で渡したテキストを代入
    // 新規/編集があるのでこうしている
    textArea.value = text
    // markedは、HTMLに追加したプラグイン
    main.innerHTML = marked(text)

    // 削除のクリックイベントの登録
    deleteBtn.addEventListener('click', () => {
      deleteNote(note)
    })

    // 編集ボタンのクリックイベント
    editBtn.addEventListener('click', () => {
      editNote(main, textArea)
    })

    // テキストエリアのイベント
    textArea.addEventListener('input', (e) => {
      const { value } = e.target

      main.innerHTML = marked(value)

      // ローカルストレージの更新
      updateLS()
    })

    // bodyの子要素として追加
    document.body.appendChild(note)
  }

  // ローカルストレージにメモ帳を保存
  function updateLS() {
    // 要素を取得
    const notesText = document.querySelectorAll('textarea')

    const notes = []

    // 要素を格納
    notesText.forEach(note => notes.push(note.value))

    // notesという名前でローカルストレージを保存
    localStorage.setItem('notes', JSON.stringify(notes))
  }

  // メモ帳削除
  function deleteNote(note) {
    // ノートを削除
    note.remove()

    // ローカルストレージの更新
    updateLS()
  }

  // メモ帳編集
  function editNote(main, textArea) {
    // hiddenがついているものは消し、ついてないものは付与する
    main.classList.toggle('hidden')
    textArea.classList.toggle('hidden')
  }
  </script>

</body>

</html>